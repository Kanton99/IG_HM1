<!DOCTYPE html>
<html>
<body>
<canvas id="gl-canvas" width="512"" height="512"> </canvas>

<div>angle of rotation: <input id="rotation" type="number" size="1px" value="0"></div>
<div>axis of rotation: 
    <input id="axisX" type="number" value="0">
    <input id="axisY" type="number" value="0">
    <input id="axisZ" type="number" value="0">
</div>
<div>centre of rotation: 
    <input id="centreX" type="number" value="0">
    <input id="centreY" type="number" value="0">
    <input id="centreZ" type="number" value="0">
</div>
<div>
    <div>
        move camera
        <input id="cameraTX" type="range" min="-0.1" max="0.1" step="0.01" value="0">
        <input id="cameraTY" type="range" min="-0.1" max="0.1" step="0.01" value="0">
        <input id="cameraTZ" type="range" min="-0.1" max="0.1" step="0.01" value="0">
    </div>
    <div>
        rotate camera
        <input id="cameraRY" type="range" min="-1" max="1" step="0.1" value="0">
        <input id="cameraRX" type="range" min="-1" max="1" step="0.1" value="0">
        <input id="cameraRZ" type="range" min="-1" max="1" step="0.1" value="0">
    </div>
</div>
<div>bounding box controls: 
    <input id="zNear" type="number" value="0.1" step="0.1">
    <input id="zFar" type="number" value="10" step="0.1">
</div>

<script id="vertex-shader" type="x-shader/x-vertex">
#version 300 es

in  vec4 aPosition;
in  vec4 aColor;
in  vec4 aNormal; 

uniform vec4 lightPos;
uniform float angle;
uniform vec4 lightDirection;
uniform vec4 lightColor;

out vec4 vColor;
out vec3 vLighting;

uniform mat4 objectMatrix; 
uniform mat4 perspectiveMatrix;
uniform mat4 modelViewMatrix;
uniform mat4 normalMatrix;

float map(float value,float oMin,float oMax,float nMin,float nMax){
    float perc = (value-oMin)/(oMax-oMin);
    return perc * (nMax-nMin) + nMin;
}

vec3 map(vec3 value,vec3 oMin,vec3 oMax,vec3 nMin,vec3 nMax){
    vec3 perc = (value-oMin)/(oMax-oMin);
    return perc * (nMax-nMin) + nMin;
}

void main()
{
    vec4 worldPos = objectMatrix * aPosition;
    gl_Position =  perspectiveMatrix * modelViewMatrix * worldPos;

    highp vec4 transformedNormal =  normalize(normalMatrix * aNormal);
    vec3 posToLight = normalize((worldPos-lightPos).xyz);
    //vLighting = posToLight;
    highp float directional = 0.f;
    if(dot(posToLight,normalize(lightDirection.xyz))>=cos(angle)){
        directional = max(dot(transformedNormal.xyz, -normalize(lightDirection.xyz)), 0.0);
    }
    vColor = aColor;
    vLighting = (lightColor.rgb*directional);
}
</script>
<script id="fragment-shader" type="x-shader/x-fragment">
#version 300 es

precision mediump float;

in vec4 vColor;
in vec3 vLighting;
out vec4 fColor;

void
main()
{
    fColor = vec4(vColor.rgb*vLighting,1);
    //fColor = vColor;
}
</script>

<script src="../Common/initShaders.js"></script>
<script src="../Common/MV.js"></script>
<script src="Entity.js"></script>
<script src="Table.js"></script>
<script src="Spotlight.js"></script>
<script src="homework1.js"></script>

</body>
</html>
